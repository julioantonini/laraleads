$(document).ready(function(){setScrolls(),setMenuMobile(),setDataTable(),setDatePicker()});const sweetDelete=(e,a,t)=>{swal({title:e,html:a,type:"error",showCancelButton:!0,allowOutsideClick:!1,confirmButtonColor:"#3490DC",cancelButtonColor:"#6C757D",confirmButtonText:"Sim",cancelButtonText:"Não"}).then(e=>{e.value&&(window.location=t)})},setScrolls=()=>{$("#app-sidebar__content").mCustomScrollbar({theme:"minimal-dark"})},setMenuMobile=()=>{$(".app-sidebar__toggle-button").on("click",function(e){e.preventDefault(),$(".app-sidebar").toggleClass("app-sidebar--visible")})},setDataTable=()=>{$(".datatables").dataTable({order:[],language:{url:"dt/Portuguese-Brasil.json"}})};let userId,userName,userQtdLead;const handleUserDeletePopup=(e,a,t)=>{$("#form-move-lead").trigger("reset"),userId=e,userName=a,userQtdLead=t,$("#user-name").html(a),$("#user-qtd-leads").html(t),$("#user_id").val(e),$(".user-delete__popup").fadeIn()},handleClosePopup=()=>{$(".user-delete__popup").fadeOut()},sweetUserDelete=e=>{swal({title:"Apagar usuário",html:"Deseja realmente apagar o usuário "+userName+" <br/>e todos seus "+userQtdLead+" leads ?",type:"error",showCancelButton:!0,allowOutsideClick:!1,confirmButtonColor:"#3490DC",cancelButtonColor:"#6C757D",confirmButtonText:"Sim",cancelButtonText:"Não"}).then(a=>{a.value&&(window.location=e+"/"+userId)})};function setDatePicker(){var e="dd/mm/yy",a=$("#from").datepicker({dateFormat:"dd/mm/yy",defaultDate:"+1w",dayNames:["Domingo","Segunda","TerÃ§a","Quarta","Quinta","Sexta","SÃ¡bado"],dayNamesMin:["D","S","T","Q","Q","S","S","D"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","SÃƒÂ¡b","Dom"],monthNames:["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],nextText:"PrÃ³ximo",prevText:"Anterior"}).on("change",function(){t.datepicker("option","minDate",i(this))}),t=$("#to").datepicker({dateFormat:"dd/mm/yy",defaultDate:"+1w",dayNames:["Domingo","Segunda","TerÃ§a","Quarta","Quinta","Sexta","SÃ¡bado"],dayNamesMin:["D","S","T","Q","Q","S","S","D"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b","Dom"],monthNames:["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],nextText:"PrÃ³ximo",prevText:"Anterior"}).on("change",function(){a.datepicker("option","maxDate",i(this))});function i(a){var t;try{t=$.datepicker.parseDate(e,a.value)}catch(e){t=null}return t}}const handleCloseFunnelPopup=()=>{$(".funnel-popup").fadeOut()},generatetSigla=e=>{let a=e.toUpperCase();if((a=a.split(" ")).length>1){return a[0].substring(0,1)+a[1].substring(0,1)}return a[0].substring(0,2)};let isemptytHistoric=0;const handleLoadLeadInfo=e=>{$.ajax({type:"GET",url:e,timeout:5e3,contentType:"application/json; charset=utf-8",cache:!1,beforeSend:function(){$(".funnel-loading-popup").fadeIn()},error:function(){$(".funnel-loading-popup").fadeOut(),alert("Ocorreu um erro, por favor, recarregue a página")},success:function(e){$("#lead_id").val(e.id),$("#lead-sigla").html(e.name&&generatetSigla(e.name)),$("#lead-nome").html(e.name),$("#lead-email").html(e.email),$("#lead-fone").html(e.phone),$("#lead-cpf").html(e.cpf),$("#lead-data-nasc").html(e.birthdate),$("#lead-renda").html(e.income),$("#lead-mensagem").html(e.comments),$(".funnel-loading-popup").hide(),$(".message-historic").animate({scrollTop:0}),$(".funnel-popup").show();const a=$("#timeline-box");a.empty(),isemptytHistoric=!e.historics.length,e.historics.map(e=>{a.append("<div class='timeline-vertical-item'> <div class='timeline-vertical-item-user'><span></span></div><div class='timeline-vertical-item-balao'><div class='timeline-vertical-item-balao-content'><p>"+e.user.name+" <span>("+e.user.privilege.name+")</span></p><p>"+e.message.replaceAll("\n","<br/>")+"</p><p class='data-acao'><i class='far fa-clock'></i> "+dateFns.format(new Date(e.created_at),"DD/MM/YYYY [às] HH:mm")+"</p></div></div></div>")}),isemptytHistoric&&a.append("<div class='timeline-vertical-item'> <div class='timeline-vertical-item-user'><span></span></div><div class='timeline-vertical-item-balao'><div class='timeline-vertical-item-balao-content'><p>Nenhuma mensagem encontrada</p><p class='data-acao'></p></div></div></div>")}})},handleSendMessage=e=>{const a=$("#message").val().trim(),t=$("#lead_id").val();if(a.length>0){$("#message").val("");const i={lead_id:t,message:a};$.ajax({type:"POST",url:e,timeout:5e3,data:i,cache:!1,error:function(e){console.log(e),alert("Ocorreu um erro, por favor, recarregue a página")},success:function(e){const a=$("#timeline-box");isemptytHistoric&&(a.empty(),isemptytHistoric=!1),a.prepend("<div class='timeline-vertical-item'> <div class='timeline-vertical-item-user'><span></span></div><div class='timeline-vertical-item-balao'><div class='timeline-vertical-item-balao-content'><p>"+e.user.name+" <span>("+e.user.privilege.name+")</span></p><p>"+e.message.replaceAll("\n","<br/>")+"</p><p class='data-acao'><i class='far fa-clock'></i> "+dateFns.format(new Date(e.created_at),"DD/MM/YYYY [às] HH:mm")+"</p></div></div></div>"),$(".message-historic").animate({scrollTop:0})}})}};
